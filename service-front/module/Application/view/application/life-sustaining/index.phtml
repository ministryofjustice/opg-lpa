<?php
    $form = $this->formErrorTextExchange($this->form, [
        'canSustainLife' => [
            "Value is required and can't be empty" => 'Please select either option A or option B',
        ],
    ]);
    
    $form->setAttribute('class', 'form');
    $csrf           = $form->get($form->csrfName());
    $canSustainLife = $form->get('canSustainLife');
    
    $canSustainLifeValueOptions = $canSustainLife->getOptions()['value_options'];
    $canSustainLifeValueOptions[true]['label'] = "Option A: Yes. I want to give my attorneys authority to give or refuse consent to life-sustaining treatment on my behalf";
    $canSustainLifeValueOptions[false]['label'] = "Option B: No. I don’t want to give my attorneys authority to give or refuse consent to life-sustaining treatment on my behalf";
    
    $canSustainLifeValueOptions[true] += [
            'label_attributes' => [
                    'for' => 'can-sustain-life-true'
            ],
            'attributes' => [
                    'id' => 'can-sustain-life-true'
            ],
    ];
    $canSustainLifeValueOptions[false] += [
            'label_attributes' => [
                    'for' => 'can-sustain-life-false'
            ],
            'attributes' => [
                    'id' => 'can-sustain-life-false'
            ],
    ];
    $canSustainLife->setOptions(['value_options'=>$canSustainLifeValueOptions]);
    
    $submit         = $form->get('submit');
    $submit->setAttributes(['class'=>'button gotonextpart', 'value'=>'Save and continue']);
    
    $formLabel      = $this->plugin('formLabel');
    $form->prepare();
?>
<section id="life-sustaining" class="section current">
	
	<h2 class="accordion-header"><?= $this->accordionIdx($this->lpa); ?>. Can your attorneys give or refuse consent to life-sustaining treatment?</h2>

    <div class="accordion-content">
  
		<div class="section-intro">

            <p>This is a very important decision. Read the guidance carefully before you answer.</p>
            <ul>
            	<li>Life-sustaining treatment is any treatment a doctor considers necessary to keep you alive</li>
            	<li>If you don’t allow your attorneys to give or refuse consent on your behalf, your doctors will make decisions about life-sustaining treatment</li>
            	<li>Your attorneys can only make decisions about life-sustaining treatment if you don't have mental capacity</li>
            </ul>
            
    		<p><a href="/help/#topic-life-sustaining-treatment" class="js-guidance" data-journey-click="stageprompt.lpa:help:life-sustaining-treatment">Read guidance on making this decision </a></p>

		</div>

		<h3>Do you want to give your attorneys authority to make decisions about life-sustaining treatment on your behalf?</h3>
    
        <?= $this->form()->openTag($form); ?>
        
        <?= $this->formElement($csrf) ?>
        
        <?= $this->formErrorList(); ?>
        
        <div class="emphasised option group">
            <?= $this->formElement($canSustainLife) ?>
            
            <p class='form-element-errors'>
                <?= $this->formElementErrors($canSustainLife) ?>
            </p>
        </div>
        
        <p>Later on, you’ll need to sign and date the option you’ve chosen on your printed LPA document. Your signature must be witnessed.</p>
        
        <div class="accordion-actions">
			<p>
                <input type="submit" name="save" value="Save and continue" class="button gotonextpart">
            </p>
        </div>
                
        <?= $this->form()->closeTag(); ?>
    
    </div>
    
</section>